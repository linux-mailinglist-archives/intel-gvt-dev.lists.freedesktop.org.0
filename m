Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gvt-dev@lfdr.de
Delivered-To: lists+intel-gvt-dev@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id 5AC6CB46FA
	for <lists+intel-gvt-dev@lfdr.de>; Tue, 17 Sep 2019 07:48:45 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id F0E176E116;
	Tue, 17 Sep 2019 05:48:43 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 1E26E6E111;
 Tue, 17 Sep 2019 05:48:42 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from fmsmga005.fm.intel.com ([10.253.24.32])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 16 Sep 2019 22:48:41 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,515,1559545200"; d="scan'208";a="386441177"
Received: from xzhan34-mobl3.bj.intel.com ([10.238.154.70])
 by fmsmga005.fm.intel.com with ESMTP; 16 Sep 2019 22:48:39 -0700
From: Xiaolin Zhang <xiaolin.zhang@intel.com>
To: intel-gvt-dev@lists.freedesktop.org,
	intel-gfx@lists.freedesktop.org
Subject: [PATCH v10 1/9] drm/i915: introduced vgpu pv capability
Date: Tue, 17 Sep 2019 13:48:12 +0800
Message-Id: <1568699301-2799-2-git-send-email-xiaolin.zhang@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1568699301-2799-1-git-send-email-xiaolin.zhang@intel.com>
References: <1568699301-2799-1-git-send-email-xiaolin.zhang@intel.com>
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: Xiaolin Zhang <xiaolin.zhang@intel.com>, zhenyu.z.wang@intel.com,
 joonas.lahtinen@linux.intel.com, hang.yuan@intel.com, zhiyuan.lv@intel.com,
 chris@chris-wilson.co.uk, zhi.a.wang@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

cHYgY2FwYWJpbGl0eSBmb3IgdmdwdSB3YXMgaW50cm9kdWNlZCBieSBwdl9jYXBzIGluIHN0cnVj
dAppOTE1X3ZpcnR1YWxfZ3B1IGFuZCBhIG5ldyBwdl9jYXBzIHJlZ2lzdGVyIGZvciBob3N0IEdW
VAp3YXMgZGVmaW5lZCBpbiBzdHJ1Y3Qgdmd0X2lmIGZvciB2Z3B1IHB2IG9wdGltaXphdGlvbi4K
CmJvdGggb2YgdGhlbSBhcmUgdXNlZCB0byBjb250cm9sIGRpZmZlcmVudCBmZWF0dXJlIHB2IG9w
dGltaXphdGlvbgpzdXBwb3J0ZWQgYW5kIGltcGxlbWVudGVkIGJ5IGJvdGggZ3Vlc3QgYW5kIGhv
c3QuCgpUaGVzZSBmaWVsZHMgYXJlIGRlZmF1bHQgemVybywgbm8gYW55IHB2IGZlYXR1cmUgZW5h
YmxlZC4KCml0IGFsc28gYWRkcyBWR1RfQ0FQU19QViBjYXBhYmlsaXR5IEJJVCBmb3IgZ3Vlc3Qg
dG8gY2hlY2sgR1ZUZwpjYW4gc3VwcG9ydCBQViBmZWF0dXJlIG9yIG5vdC4KCnYwOiBSRkMsIGlu
dHJvdWRjZWQgZW5hYmxlX3B2bW1pbyBtb2R1bGUgcGFyYW1ldGVyLgp2MTogYWRkcmVzc2VkIFJG
QyBjb21tZW50IHRvIHJlbW92ZSBlbmFibGVfcHZtbWlvIG1vZHVsZSBwYXJhbWV0ZXIKYnkgcHYg
Y2FwYWJpbGl0eSBjaGVjay4KdjI6IHJlYmFzZS4KdjM6IGRpc3RpbmN0IHB2IGNhcHMgZnJvbSBn
dWVzdCBhbmQgaG9zdC4gcmVuYW1lZCBlbmFibGVfcHZtbWlvIHRvCnB2bW1pb19jYXBzIHdoaWNo
IGlzIHVzZWQgZm9yIGhvc3QgcHYgY2Fwcy4KdjQ6IGNvbnNvbGlkYXRlZCBhbGwgcHYgcmVsYXRl
ZCBmdW5jdG9ucyBpbnRvIGEgc2luZ2xlIGZpbGUgaTkxNV92Z3B1LmMKYW5kIHJlbmFtZWQgcHZt
bWlvIHRvIHB2X2NhcHMuCnY1OiByZWZpbmVkIFBWIHVzZXItZmFjaW5nIG1lc3NhZ2UgYW5kIHBy
aW50IHB2X2NhcHMgdW5kZXIgZGVidWdmcy4KClNpZ25lZC1vZmYtYnk6IFhpYW9saW4gWmhhbmcg
PHhpYW9saW4uemhhbmdAaW50ZWwuY29tPgotLS0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZGVidWdmcy5jIHwgIDIgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmggICAgIHwg
IDIgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcHZpbmZvLmggIHwgIDUgKysrKy0KIGRy
aXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5jICAgIHwgNDMgKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmggICAg
fCAgOSArKysrKysrKwogNSBmaWxlcyBjaGFuZ2VkLCA1OSBpbnNlcnRpb25zKCspLCAyIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZGVidWdmcy5j
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKaW5kZXggNDNkYjUwMC4uZTQw
NGMzYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kZWJ1Z2ZzLmMKQEAgLTY2LDYgKzY2LDggQEAg
c3RhdGljIGludCBpOTE1X2NhcGFiaWxpdGllcyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRh
dGEpCiAJc2VxX3ByaW50ZihtLCAiZ2VuOiAlZFxuIiwgSU5URUxfR0VOKGRldl9wcml2KSk7CiAJ
c2VxX3ByaW50ZihtLCAicGxhdGZvcm06ICVzXG4iLCBpbnRlbF9wbGF0Zm9ybV9uYW1lKGluZm8t
PnBsYXRmb3JtKSk7CiAJc2VxX3ByaW50ZihtLCAicGNoOiAlZFxuIiwgSU5URUxfUENIX1RZUEUo
ZGV2X3ByaXYpKTsKKwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoZGV2X3ByaXYpKQorCQlzZXFfcHJp
bnRmKG0sICJ2Z3B1IHB2X2NhcHM6IDB4JXhcbiIsIGRldl9wcml2LT52Z3B1LnB2X2NhcHMpOwog
CiAJbXNnID0gIm4vYSI7CiAjaWZkZWYgQ09ORklHX0lOVEVMX0lPTU1VCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkx
NV9kcnYuaAppbmRleCBiZjYwMDg4Li4xOWZiYmVmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZHJ2LmgK
QEAgLTk5LDYgKzk5LDcgQEAKICNpbmNsdWRlICJpOTE1X2lycS5oIgogCiAjaW5jbHVkZSAiaW50
ZWxfZ3Z0LmgiCisjaW5jbHVkZSAiaTkxNV9wdmluZm8uaCIKIAogLyogR2VuZXJhbCBjdXN0b21p
emF0aW9uOgogICovCkBAIC05NzEsNiArOTcyLDcgQEAgc3RydWN0IGk5MTVfdmlydHVhbF9ncHUg
ewogCXN0cnVjdCBtdXRleCBsb2NrOyAvKiBzZXJpYWxpc2VzIHNlbmRpbmcgb2YgZzJ2X25vdGlm
eSBjb21tYW5kIHBrdHMgKi8KIAlib29sIGFjdGl2ZTsKIAl1MzIgY2FwczsKKwl1MzIgcHZfY2Fw
czsKIH07CiAKIC8qIHVzZWQgaW4gY29tcHV0aW5nIHRoZSBuZXcgd2F0ZXJtYXJrcyBzdGF0ZSAq
LwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wdmluZm8uaCBiL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfcHZpbmZvLmgKaW5kZXggNjgzZTk3YS4uYWQzOThiNCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wdmluZm8uaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X3B2aW5mby5oCkBAIC01Nyw2ICs1Nyw3IEBAIGVudW0gdmd0X2cy
dl90eXBlIHsKICNkZWZpbmUgVkdUX0NBUFNfRlVMTF9QUEdUVAkJQklUKDIpCiAjZGVmaW5lIFZH
VF9DQVBTX0hXU1BfRU1VTEFUSU9OCQlCSVQoMykKICNkZWZpbmUgVkdUX0NBUFNfSFVHRV9HVFQJ
CUJJVCg0KQorI2RlZmluZSBWR1RfQ0FQU19QVgkJQklUKDUpCiAKIHN0cnVjdCB2Z3RfaWYgewog
CXU2NCBtYWdpYzsJCS8qIFZHVF9NQUdJQyAqLwpAQCAtMTA5LDcgKzExMCw5IEBAIHN0cnVjdCB2
Z3RfaWYgewogCXUzMiBleGVjbGlzdF9jb250ZXh0X2Rlc2NyaXB0b3JfbG87CiAJdTMyIGV4ZWNs
aXN0X2NvbnRleHRfZGVzY3JpcHRvcl9oaTsKIAotCXUzMiAgcnN2N1sweDIwMCAtIDI0XTsgICAg
LyogcGFkIHRvIG9uZSBwYWdlICovCisJdTMyIHB2X2NhcHM7CisKKwl1MzIgIHJzdjdbMHgyMDAg
LSAyNV07ICAgIC8qIHBhZCB0byBvbmUgcGFnZSAqLwogfSBfX3BhY2tlZDsKIAogI2RlZmluZSB2
Z3RpZl9vZmZzZXQoeCkgKG9mZnNldG9mKHN0cnVjdCB2Z3RfaWYsIHgpKQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ZncHUuYwppbmRleCA5NjhiZTI2Li45ODE5NTliIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9pOTE1X3ZncHUuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Zn
cHUuYwpAQCAtOTUsNyArOTUsMTMgQEAgdm9pZCBpOTE1X2RldGVjdF92Z3B1KHN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCWRldl9wcml2LT52Z3B1LmFjdGl2ZSA9IHRydWU7
CiAJbXV0ZXhfaW5pdCgmZGV2X3ByaXYtPnZncHUubG9jayk7Ci0JRFJNX0lORk8oIlZpcnR1YWwg
R1BVIGZvciBJbnRlbCBHVlQtZyBkZXRlY3RlZC5cbiIpOworCisJaWYgKCFpbnRlbF92Z3B1X2No
ZWNrX3B2X2NhcHMoZGV2X3ByaXYsIHNoYXJlZF9hcmVhKSkgeworCQlEUk1fSU5GTygiVmlydHVh
bCBHUFUgZm9yIEludGVsIEdWVC1nIGRldGVjdGVkLlxuIik7CisJCWdvdG8gb3V0OworCX0KKwor
CURSTV9JTkZPKCJWaXJ0dWFsIEdQVSBmb3IgSW50ZWwgR1ZULWcgZGV0ZWN0ZWQgd2l0aCBQViBP
cHRpbWl6ZWQuXG4iKTsKIAogb3V0OgogCXBjaV9pb3VubWFwKHBkZXYsIHNoYXJlZF9hcmVhKTsK
QEAgLTMwMCwzICszMDYsMzggQEAgaW50IGludGVsX3ZndF9iYWxsb29uKHN0cnVjdCBpOTE1X2dn
dHQgKmdndHQpCiAJRFJNX0VSUk9SKCJWR1QgYmFsbG9vbiBmYWlsXG4iKTsKIAlyZXR1cm4gcmV0
OwogfQorCisvKgorICogaTkxNSB2Z3B1IFBWIHN1cHBvcnQgZm9yIExpbnV4CisgKi8KKworLyoq
CisgKiBpbnRlbF92Z3B1X2NoZWNrX3B2X2NhcHMgLSBkZXRlY3QgdmlydHVhbCBHUFUgUFYgY2Fw
YWJpbGl0aWVzCisgKiBAZGV2X3ByaXY6IGk5MTUgZGV2aWNlIHByaXZhdGUKKyAqCisgKiBUaGlz
IGZ1bmN0aW9uIGlzIGNhbGxlZCBhdCB0aGUgaW5pdGlhbGl6YXRpb24gc3RhZ2UsIHRvIGRldGVj
dCBWR1BVCisgKiBQViBjYXBhYmlsaXRpZXMKKyAqCisgKiBJZiBndWVzdCB3YW50cyB0byBlbmFi
bGUgcHZfY2FwcywgaXQgbmVlZHMgdG8gY29uZmlnIGl0IGV4cGxpY2l0bHkKKyAqIHRocm91Z2gg
dmd0X2lmIGludGVyZmFjZSBmcm9tIGd2dCBsYXllci4KKyAqLworYm9vbCBpbnRlbF92Z3B1X2No
ZWNrX3B2X2NhcHMoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAorCQl2b2lkIF9f
aW9tZW0gKnNoYXJlZF9hcmVhKQoreworCXUzMiBndnRfcHZjYXBzOworCXUzMiBwdmNhcHMgPSAw
OworCisJaWYgKCFpbnRlbF92Z3B1X2hhc19wdl9jYXBzKGRldl9wcml2KSkKKwkJcmV0dXJuIGZh
bHNlOworCisJLyogUFYgY2FwYWJpbGl0eSBuZWdvdGlhdGlvbiBiZXR3ZWVuIFBWIGd1ZXN0IGFu
ZCBHVlQgKi8KKwlndnRfcHZjYXBzID0gcmVhZGwoc2hhcmVkX2FyZWEgKyB2Z3RpZl9vZmZzZXQo
cHZfY2FwcykpOworCXB2Y2FwcyA9IGRldl9wcml2LT52Z3B1LnB2X2NhcHMgJiBndnRfcHZjYXBz
OworCWRldl9wcml2LT52Z3B1LnB2X2NhcHMgPSBwdmNhcHM7CisJd3JpdGVsKHB2Y2Fwcywgc2hh
cmVkX2FyZWEgKyB2Z3RpZl9vZmZzZXQocHZfY2FwcykpOworCisJaWYgKCFwdmNhcHMpCisJCXJl
dHVybiBmYWxzZTsKKworCXJldHVybiB0cnVlOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvaTkxNV92Z3B1LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuaApp
bmRleCA4YjM2NjNkLi5iYmU1NmI1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X3ZncHUuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuaApAQCAtNDMs
NyArNDMsMTYgQEAKIAlyZXR1cm4gZGV2X3ByaXYtPnZncHUuY2FwcyAmIFZHVF9DQVBTX0hVR0Vf
R1RUOwogfQogCitzdGF0aWMgaW5saW5lIGJvb2wKK2ludGVsX3ZncHVfaGFzX3B2X2NhcHMoc3Ry
dWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQoreworCXJldHVybiBkZXZfcHJpdi0+dmdw
dS5jYXBzICYgVkdUX0NBUFNfUFY7Cit9CisKIGludCBpbnRlbF92Z3RfYmFsbG9vbihzdHJ1Y3Qg
aTkxNV9nZ3R0ICpnZ3R0KTsKIHZvaWQgaW50ZWxfdmd0X2RlYmFsbG9vbihzdHJ1Y3QgaTkxNV9n
Z3R0ICpnZ3R0KTsKIAorLyogaTkxNSB2Z3B1IHB2IHJlbGF0ZWQgZnVuY3Rpb25zICovCitib29s
IGludGVsX3ZncHVfY2hlY2tfcHZfY2FwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3By
aXYsCisJCXZvaWQgX19pb21lbSAqc2hhcmVkX2FyZWEpOwogI2VuZGlmIC8qIF9JOTE1X1ZHUFVf
SF8gKi8KLS0gCjEuOC4zLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCmludGVsLWd2dC1kZXYgbWFpbGluZyBsaXN0CmludGVsLWd2dC1kZXZAbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlz
dGluZm8vaW50ZWwtZ3Z0LWRldg==
