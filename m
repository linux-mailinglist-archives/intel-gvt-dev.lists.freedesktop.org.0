Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gvt-dev@lfdr.de
Delivered-To: lists+intel-gvt-dev@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id C230A786D3
	for <lists+intel-gvt-dev@lfdr.de>; Mon, 29 Jul 2019 09:59:13 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id D51BA8982C;
	Mon, 29 Jul 2019 07:59:09 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mga18.intel.com (mga18.intel.com [134.134.136.126])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 31D408982C;
 Mon, 29 Jul 2019 07:59:09 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by orsmga106.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 29 Jul 2019 00:57:50 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.64,322,1559545200"; d="scan'208";a="255150083"
Received: from vca-bj102.bj.intel.com ([10.240.193.76])
 by orsmga001.jf.intel.com with ESMTP; 29 Jul 2019 00:57:48 -0700
From: Xiaolin Zhang <xiaolin.zhang@intel.com>
To: intel-gvt-dev@lists.freedesktop.org,
	intel-gfx@lists.freedesktop.org
Subject: [PATCH v9 4/9] drm/i915: vgpu ppgtt update pv optimization
Date: Tue, 30 Jul 2019 00:32:37 +0800
Message-Id: <1564417962-74325-5-git-send-email-xiaolin.zhang@intel.com>
X-Mailer: git-send-email 1.8.3.1
In-Reply-To: <1564417962-74325-1-git-send-email-xiaolin.zhang@intel.com>
References: <1564417962-74325-1-git-send-email-xiaolin.zhang@intel.com>
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: Xiaolin Zhang <xiaolin.zhang@intel.com>, zhenyu.z.wang@intel.com,
 joonas.lahtinen@linux.intel.com, hang.yuan@intel.com, min.he@intel.com,
 zhiyuan.lv@intel.com, chris@chris-wilson.co.uk, zhi.a.wang@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

VGhpcyBwYXRjaCBleHRlbmRzIHZncHUgcHBndHQgZzJ2IG5vdGlmaWNhdGlvbiB0byBub3RpZnkg
aG9zdApHVlQtZyBvZiBwcGd0dCB1cGRhdGUgZnJvbSBndWVzdCBpbmNsdWRpbmcgYWxsb2NfNGx2
bCwgY2xlYXJfNGx2NAphbmQgaW5zZXJ0XzRsdmwuCgpUaGVzZSB1cGRhdGVzIHVzZSB0aGUgc2hh
cmVkIG1lbW9yeSBwYWdlIHRvIHBhc3Mgc3RydWN0IHB2X3BwZ3R0X3VwZGF0ZQpmcm9tIGd1ZXN0
IHRvIEdWVCB3aGljaCBpcyB1c2VkIGZvciBwdiBvcHRpbWlhdGlvbiBpbXBsZW1lYXRpb24gd2l0
aGluCmhvc3QgR1ZUIHNpZGUuCgpUaGlzIHBhdGNoIGFsc28gYWRkIG9uZSBuZXcgcHZfY2FwcyBs
ZXZlbCB0byBjb250cm9sIHBwZ3R0IHVwZGF0ZS4KClVzZSBQVl9QUEdUVF9VUERBVEUgdG8gY29u
dHJvbCB0aGlzIGxldmVsIG9mIHB2IG9wdGltaXphdGlvbi4KCnYwOiBSRkMuCnYxOiByZWJhc2Vk
Lgp2MjogYWRkZWQgcHYgY2FsbGJhY2tzIGZvciB2bS57YWxsb2NhdGVfdmFfcmFuZ2UsIGluc2Vy
dF9lbnRyaWVzLApjbGVhcl9yYW5nZX0gd2l0aGluIHBwZ3R0Lgp2MzogcmViYXNlZCwgZGlzYWJs
ZSBodWdlIHBhZ2UgcHBndHQgc3VwcG9ydCB3aGVuIHVzaW5nIFBWTU1JTyBwcGd0dAp1cGRhdGUg
ZHVlIHRvIGNvbXBsZXggYW5kIHBlcmZvcm1hbmNlIGltcGFjdC4KdjQ6IG1vdmVkIGFsbG9jL2lu
c2VydC9jbGVhcl80bHZsIHB2IGNhbGxiYWNrcyBpbnRvIGk5MTVfdmdwdV9wdi5jIGFuZAphZGRl
ZCBhIHNpbmdsZSBpbnRlbF92Z3B1X2NvbmZpZ19wdl9jYXBzKCkgZm9yIHZncHUgcHYgY2FsbGJh
Y2tzIHNldHVwLgp2NTogcmViYXNlLgp2NjogcmViYXNlLgp2NzogcmViYXNlLgoKU2lnbmVkLW9m
Zi1ieTogWGlhb2xpbiBaaGFuZyA8eGlhb2xpbi56aGFuZ0BpbnRlbC5jb20+Ci0tLQogZHJpdmVy
cy9ncHUvZHJtL2k5MTUvaTkxNV9nZW0uYyAgICAgfCAgMyArLQogZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV9nZW1fZ3R0LmMgfCAxMCArKystLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9n
ZW1fZ3R0LmggfCAgOCArKysrCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuYyAgICB8
IDc5ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIGRyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfdmdwdS5oICAgIHwgMjUgKysrKysrKysrKysrCiA1IGZpbGVzIGNoYW5nZWQs
IDEyMCBpbnNlcnRpb25zKCspLCA1IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbS5j
CmluZGV4IDAxZGQwZDFkLi5hZDcyYzdhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfZ2VtLmMKQEAgLTE0
MTksNyArMTQxOSw4IEBAIGludCBpOTE1X2dlbV9pbml0KHN0cnVjdCBkcm1faTkxNV9wcml2YXRl
ICpkZXZfcHJpdikKIAlpbnQgcmV0OwogCiAJLyogV2UgbmVlZCB0byBmYWxsYmFjayB0byA0SyBw
YWdlcyBpZiBob3N0IGRvZXNuJ3Qgc3VwcG9ydCBodWdlIGd0dC4gKi8KLQlpZiAoaW50ZWxfdmdw
dV9hY3RpdmUoZGV2X3ByaXYpICYmICFpbnRlbF92Z3B1X2hhc19odWdlX2d0dChkZXZfcHJpdikp
CisJaWYgKChpbnRlbF92Z3B1X2FjdGl2ZShkZXZfcHJpdikgJiYgIWludGVsX3ZncHVfaGFzX2h1
Z2VfZ3R0KGRldl9wcml2KSkKKwkJfHwgaW50ZWxfdmdwdV9lbmFibGVkX3B2X2NhcHMoZGV2X3By
aXYsIFBWX1BQR1RUX1VQREFURSkpCiAJCW1rd3JpdGVfZGV2aWNlX2luZm8oZGV2X3ByaXYpLT5w
YWdlX3NpemVzID0KIAkJCUk5MTVfR1RUX1BBR0VfU0laRV80SzsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV9nZW1fZ3R0LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbV9ndHQuYwppbmRleCA0ZGQxZmE5Li42NjdhOGVkIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9p
OTE1X2dlbV9ndHQuYwpAQCAtOTk3LDcgKzk5Nyw3IEBAIHN0YXRpYyB1NjQgX19nZW44X3BwZ3R0
X2NsZWFyKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKiBjb25zdCB2bSwKIAlyZXR1cm4gc3Rh
cnQ7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjhfcHBndHRfY2xlYXIoc3RydWN0IGk5MTVfYWRkcmVz
c19zcGFjZSAqdm0sCit2b2lkIGdlbjhfcHBndHRfY2xlYXIoc3RydWN0IGk5MTVfYWRkcmVzc19z
cGFjZSAqdm0sCiAJCQkgICAgIHU2NCBzdGFydCwgdTY0IGxlbmd0aCkKIHsKIAlHRU1fQlVHX09O
KCFJU19BTElHTkVEKHN0YXJ0LCBCSVRfVUxMKEdFTjhfUFRFX1NISUZUKSkpOwpAQCAtMTEwNCw3
ICsxMTA0LDcgQEAgc3RhdGljIGludCBfX2dlbjhfcHBndHRfYWxsb2Moc3RydWN0IGk5MTVfYWRk
cmVzc19zcGFjZSAqIGNvbnN0IHZtLAogCXJldHVybiByZXQ7CiB9CiAKLXN0YXRpYyBpbnQgZ2Vu
OF9wcGd0dF9hbGxvYyhzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKK2ludCBnZW44X3Bw
Z3R0X2FsbG9jKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAogCQkJICAgIHU2NCBzdGFy
dCwgdTY0IGxlbmd0aCkKIHsKIAl1NjQgZnJvbTsKQEAgLTEzMTcsNyArMTMxNyw3IEBAIHN0YXRp
YyB2b2lkIGdlbjhfcHBndHRfaW5zZXJ0X2h1Z2VfZW50cmllcyhzdHJ1Y3QgaTkxNV92bWEgKnZt
YSwKIAl9IHdoaWxlIChpdGVyLT5zZyk7CiB9CiAKLXN0YXRpYyB2b2lkIGdlbjhfcHBndHRfaW5z
ZXJ0XzRsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCit2b2lkIGdlbjhfcHBndHRf
aW5zZXJ0XzRsdmwoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCiAJCQkJICAgc3RydWN0
IGk5MTVfdm1hICp2bWEsCiAJCQkJICAgZW51bSBpOTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVs
LAogCQkJCSAgIHUzMiBmbGFncykKQEAgLTE1MTAsOCArMTUxMCwxMCBAQCBzdGF0aWMgc3RydWN0
IGk5MTVfcHBndHQgKmdlbjhfcHBndHRfY3JlYXRlKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpp
OTE1KQogCXBwZ3R0LT52bS5hbGxvY2F0ZV92YV9yYW5nZSA9IGdlbjhfcHBndHRfYWxsb2M7CiAJ
cHBndHQtPnZtLmNsZWFyX3JhbmdlID0gZ2VuOF9wcGd0dF9jbGVhcjsKIAotCWlmIChpbnRlbF92
Z3B1X2FjdGl2ZShpOTE1KSkKKwlpZiAoaW50ZWxfdmdwdV9hY3RpdmUoaTkxNSkpIHsKKwkJaW50
ZWxfdmdwdV9jb25maWdfcHZfY2FwcyhpOTE1LCBQVl9QUEdUVF9VUERBVEUsIHBwZ3R0KTsKIAkJ
Z2VuOF9wcGd0dF9ub3RpZnlfdmd0KHBwZ3R0LCB0cnVlKTsKKwl9CiAKIAlwcGd0dC0+dm0uY2xl
YW51cCA9IGdlbjhfcHBndHRfY2xlYW51cDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L2k5MTUvaTkxNV9nZW1fZ3R0LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQu
aAppbmRleCBjZWE1OWVmLi5iNGY0NzE3IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9pOTE1X2dlbV9ndHQuaAorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2dlbV9ndHQu
aApAQCAtNTc4LDYgKzU3OCwxNCBAQCBzdGF0aWMgaW5saW5lIHZvaWQgaTkxNV92bV9wdXQoc3Ry
dWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0pCiB2b2lkIGdlbjZfcHBndHRfdW5waW4oc3RydWN0
IGk5MTVfcHBndHQgKmJhc2UpOwogdm9pZCBnZW42X3BwZ3R0X3VucGluX2FsbChzdHJ1Y3QgaTkx
NV9wcGd0dCAqYmFzZSk7CiAKK3ZvaWQgZ2VuOF9wcGd0dF9jbGVhcihzdHJ1Y3QgaTkxNV9hZGRy
ZXNzX3NwYWNlICp2bSwKKwkJdTY0IHN0YXJ0LCB1NjQgbGVuZ3RoKTsKK3ZvaWQgZ2VuOF9wcGd0
dF9pbnNlcnRfNGx2bChzdHJ1Y3QgaTkxNV9hZGRyZXNzX3NwYWNlICp2bSwKKwkJc3RydWN0IGk5
MTVfdm1hICp2bWEsCisJCWVudW0gaTkxNV9jYWNoZV9sZXZlbCBjYWNoZV9sZXZlbCwgdTMyIGZs
YWdzKTsKK2ludCBnZW44X3BwZ3R0X2FsbG9jKHN0cnVjdCBpOTE1X2FkZHJlc3Nfc3BhY2UgKnZt
LAorCQl1NjQgc3RhcnQsIHU2NCBsZW5ndGgpOworCiB2b2lkIGk5MTVfZ2VtX3N1c3BlbmRfZ3R0
X21hcHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdik7CiB2b2lkIGk5MTVf
Z2VtX3Jlc3RvcmVfZ3R0X21hcHBpbmdzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dik7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5jIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMKaW5kZXggMTA1MTJkYS4uMmUzYTAyNSAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMKKysrIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMKQEAgLTk2LDYgKzk2LDkgQEAgdm9pZCBpOTE1X2RldGVj
dF92Z3B1KHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJpdikKIAogCWRldl9wcml2LT52
Z3B1LmFjdGl2ZSA9IHRydWU7CiAKKwkvKiBndWVzdCBkcml2ZXIgUFYgY2FwYWJpbGl0eSAqLwor
CWRldl9wcml2LT52Z3B1LnB2X2NhcHMgPSBQVl9QUEdUVF9VUERBVEU7CisKIAlpZiAoIWludGVs
X3ZncHVfY2hlY2tfcHZfY2FwcyhkZXZfcHJpdiwgc2hhcmVkX2FyZWEpKSB7CiAJCURSTV9JTkZP
KCJWaXJ0dWFsIEdQVSBmb3IgSW50ZWwgR1ZULWcgZGV0ZWN0ZWQuXG4iKTsKIAkJZ290byBvdXQ7
CkBAIC0zMTgsNiArMzIxLDgyIEBAIGludCBpbnRlbF92Z3RfYmFsbG9vbihzdHJ1Y3QgaTkxNV9n
Z3R0ICpnZ3R0KQogICogaTkxNSB2Z3B1IFBWIHN1cHBvcnQgZm9yIExpbnV4CiAgKi8KIAorc3Rh
dGljIGludCB2Z3B1X3BwZ3R0X3B2X3VwZGF0ZShzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2
X3ByaXYsCisJCXUzMiBhY3Rpb24sIHU2NCBwZHAsIHU2NCBzdGFydCwgdTY0IGxlbmd0aCwgdTMy
IGNhY2hlX2xldmVsKQoreworCXUzMiBkYXRhWzhdOworCisJZGF0YVswXSA9IGFjdGlvbjsKKwlk
YXRhWzFdID0gbG93ZXJfMzJfYml0cyhwZHApOworCWRhdGFbMl0gPSB1cHBlcl8zMl9iaXRzKHBk
cCk7CisJZGF0YVszXSA9IGxvd2VyXzMyX2JpdHMoc3RhcnQpOworCWRhdGFbNF0gPSB1cHBlcl8z
Ml9iaXRzKHN0YXJ0KTsKKwlkYXRhWzVdID0gbG93ZXJfMzJfYml0cyhsZW5ndGgpOworCWRhdGFb
Nl0gPSB1cHBlcl8zMl9iaXRzKGxlbmd0aCk7CisJZGF0YVs3XSA9IGNhY2hlX2xldmVsOworCisJ
cmV0dXJuIGludGVsX3ZncHVfcHZfc2VuZChkZXZfcHJpdiwgZGF0YSwgQVJSQVlfU0laRShkYXRh
KSk7Cit9CisKK3N0YXRpYyB2b2lkIGdlbjhfcHBndHRfY2xlYXJfNGx2bF9wdihzdHJ1Y3QgaTkx
NV9hZGRyZXNzX3NwYWNlICp2bSwKKwkJdTY0IHN0YXJ0LCB1NjQgbGVuZ3RoKQoreworCXN0cnVj
dCBpOTE1X3BwZ3R0ICpwcGd0dCA9IGk5MTVfdm1fdG9fcHBndHQodm0pOworCXN0cnVjdCBkcm1f
aTkxNV9wcml2YXRlICpkZXZfcHJpdiA9IHZtLT5pOTE1OworCisJZ2VuOF9wcGd0dF9jbGVhcih2
bSwgc3RhcnQsIGxlbmd0aCk7CisJdmdwdV9wcGd0dF9wdl91cGRhdGUoZGV2X3ByaXYsIFBWX0FD
VElPTl9QUEdUVF9MNF9DTEVBUiwKKwkJcHhfZG1hKHBwZ3R0LT5wZCksIHN0YXJ0LCBsZW5ndGgs
IDApOworfQorCitzdGF0aWMgdm9pZCBnZW44X3BwZ3R0X2luc2VydF80bHZsX3B2KHN0cnVjdCBp
OTE1X2FkZHJlc3Nfc3BhY2UgKnZtLAorCQlzdHJ1Y3QgaTkxNV92bWEgKnZtYSwKKwkJZW51bSBp
OTE1X2NhY2hlX2xldmVsIGNhY2hlX2xldmVsLCB1MzIgZmxhZ3MpCit7CisJc3RydWN0IGk5MTVf
cHBndHQgKnBwZ3R0ID0gaTkxNV92bV90b19wcGd0dCh2bSk7CisJc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2ID0gdm0tPmk5MTU7CisJdTY0IHN0YXJ0ID0gdm1hLT5ub2RlLnN0YXJ0
OworCXU2NCBsZW5ndGggPSB2bWEtPm5vZGUuc2l6ZTsKKworCWdlbjhfcHBndHRfaW5zZXJ0XzRs
dmwodm0sIHZtYSwgY2FjaGVfbGV2ZWwsIGZsYWdzKTsKKwl2Z3B1X3BwZ3R0X3B2X3VwZGF0ZShk
ZXZfcHJpdiwgUFZfQUNUSU9OX1BQR1RUX0w0X0lOU0VSVCwKKwkJcHhfZG1hKHBwZ3R0LT5wZCks
IHN0YXJ0LCBsZW5ndGgsIGNhY2hlX2xldmVsKTsKK30KKworc3RhdGljIGludCBnZW44X3BwZ3R0
X2FsbG9jXzRsdmxfcHYoc3RydWN0IGk5MTVfYWRkcmVzc19zcGFjZSAqdm0sCisJCXU2NCBzdGFy
dCwgdTY0IGxlbmd0aCkKK3sKKwlzdHJ1Y3QgaTkxNV9wcGd0dCAqcHBndHQgPSBpOTE1X3ZtX3Rv
X3BwZ3R0KHZtKTsKKwlzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYgPSB2bS0+aTkx
NTsKKwlpbnQgcmV0OworCisJcmV0ID0gZ2VuOF9wcGd0dF9hbGxvYyh2bSwgc3RhcnQsIGxlbmd0
aCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldHVybiB2Z3B1X3BwZ3R0X3B2X3Vw
ZGF0ZShkZXZfcHJpdiwgUFZfQUNUSU9OX1BQR1RUX0w0X0FMTE9DLAorCQlweF9kbWEocHBndHQt
PnBkKSwgc3RhcnQsIGxlbmd0aCwgMCk7Cit9CisKKy8qCisgKiBjb25maWcgZ3Vlc3QgZHJpdmVy
IFBWIG9wcyBmb3IgZGlmZmVyZW50IFBWIGZlYXR1cmVzCisgKi8KK3ZvaWQgaW50ZWxfdmdwdV9j
b25maWdfcHZfY2FwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJCWVudW0g
cHZfY2FwcyBjYXAsIHZvaWQgKmRhdGEpCit7CisJc3RydWN0IGk5MTVfcHBndHQgKnBwZ3R0Owor
CisJaWYgKCFpbnRlbF92Z3B1X2VuYWJsZWRfcHZfY2FwcyhkZXZfcHJpdiwgY2FwKSkKKwkJcmV0
dXJuOworCisJaWYgKGNhcCA9PSBQVl9QUEdUVF9VUERBVEUpIHsKKwkJcHBndHQgPSAoc3RydWN0
IGk5MTVfcHBndHQgKilkYXRhOworCQlwcGd0dC0+dm0uYWxsb2NhdGVfdmFfcmFuZ2UgPSBnZW44
X3BwZ3R0X2FsbG9jXzRsdmxfcHY7CisJCXBwZ3R0LT52bS5pbnNlcnRfZW50cmllcyA9IGdlbjhf
cHBndHRfaW5zZXJ0XzRsdmxfcHY7CisJCXBwZ3R0LT52bS5jbGVhcl9yYW5nZSA9IGdlbjhfcHBn
dHRfY2xlYXJfNGx2bF9wdjsKKwl9Cit9CisKIC8qKgogICogd2FpdF9mb3JfZGVzY191cGRhdGUg
LSBXYWl0IGZvciB0aGUgY29tbWFuZCBidWZmZXIgZGVzY3JpcHRvciB1cGRhdGUuCiAgKiBAZGVz
YzoJYnVmZmVyIGRlc2NyaXB0b3IKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdmdwdS5oIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmgKaW5kZXggYzQ5NGJl
Yi4uYjBmZWU1YiAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmgK
KysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmgKQEAgLTMzLDYgKzMzLDIxIEBA
CiAjZGVmaW5lIFBWX0NNRF9PRkYJCShQQUdFX1NJWkUvMikKIAogLyoKKyAqIGRlZmluZSBkaWZm
ZXJlbnQgY2FwYWJpbGl0aWVzIG9mIFBWIG9wdGltaXphdGlvbgorICovCitlbnVtIHB2X2NhcHMg
eworCVBWX1BQR1RUX1VQREFURSA9IDB4MSwKK307CisKKy8qIFBWIGFjdGlvbnMgKi8KK2VudW0g
aW50ZWxfdmdwdV9wdl9hY3Rpb24geworCVBWX0FDVElPTl9ERUZBVUxUID0gMHgwLAorCVBWX0FD
VElPTl9QUEdUVF9MNF9BTExPQywKKwlQVl9BQ1RJT05fUFBHVFRfTDRfQ0xFQVIsCisJUFZfQUNU
SU9OX1BQR1RUX0w0X0lOU0VSVCwKK307CisKKy8qCiAgKiBBIHNoYXJlZCBwYWdlKDRLQikgYmV0
d2VlbiBndnQgYW5kIFZNLCBjb3VsZCBiZSBhbGxvY2F0ZWQgYnkgZ3Vlc3QgZHJpdmVyCiAgKiBv
ciBhIGZpeGVkIGxvY2F0aW9uIGluIFBDSSBiYXIgMCByZWdpb24KICAqLwpAQCAtMTIwLDYgKzEz
NSwxNCBAQCBzdHJ1Y3QgaTkxNV92aXJ0dWFsX2dwdV9wdiB7CiAJcmV0dXJuIGRldl9wcml2LT52
Z3B1LmNhcHMgJiBWR1RfQ0FQU19QVjsKIH0KIAorc3RhdGljIGlubGluZSBib29sCitpbnRlbF92
Z3B1X2VuYWJsZWRfcHZfY2FwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYsCisJ
CWVudW0gcHZfY2FwcyBjYXApCit7CisJcmV0dXJuIChkZXZfcHJpdi0+dmdwdS5hY3RpdmUpICYm
IGludGVsX3ZncHVfaGFzX3B2X2NhcHMoZGV2X3ByaXYpCisJCQkmJiAoZGV2X3ByaXYtPnZncHUu
cHZfY2FwcyAmIGNhcCk7Cit9CisKIHN0YXRpYyBpbmxpbmUgdm9pZAogaW50ZWxfdmdwdV9wdl9u
b3RpZnkoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2KQogewpAQCAtMTM5LDQgKzE2
Miw2IEBAIHN0cnVjdCBpOTE1X3ZpcnR1YWxfZ3B1X3B2IHsKIC8qIGk5MTUgdmdwdSBwdiByZWxh
dGVkIGZ1bmN0aW9ucyAqLwogYm9vbCBpbnRlbF92Z3B1X2NoZWNrX3B2X2NhcHMoc3RydWN0IGRy
bV9pOTE1X3ByaXZhdGUgKmRldl9wcml2LAogCQl2b2lkIF9faW9tZW0gKnNoYXJlZF9hcmVhKTsK
K3ZvaWQgaW50ZWxfdmdwdV9jb25maWdfcHZfY2FwcyhzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAq
ZGV2X3ByaXYsCisJCWVudW0gcHZfY2FwcyBjYXAsIHZvaWQgKmRhdGEpOwogI2VuZGlmIC8qIF9J
OTE1X1ZHUFVfSF8gKi8KLS0gCjEuOC4zLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCmludGVsLWd2dC1kZXYgbWFpbGluZyBsaXN0CmludGVsLWd2dC1k
ZXZAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21h
aWxtYW4vbGlzdGluZm8vaW50ZWwtZ3Z0LWRldg==
