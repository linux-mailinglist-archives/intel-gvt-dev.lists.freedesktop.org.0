Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gvt-dev@lfdr.de
Delivered-To: lists+intel-gvt-dev@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 6A47432835
	for <lists+intel-gvt-dev@lfdr.de>; Mon,  3 Jun 2019 08:03:20 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id E46E389948;
	Mon,  3 Jun 2019 06:03:18 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 8C4B589935;
 Mon,  3 Jun 2019 06:03:17 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga003.jf.intel.com ([10.7.209.27])
 by fmsmga105.fm.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 02 Jun 2019 23:03:17 -0700
X-ExtLoop1: 1
Received: from xzhan34-mobl3.bj.intel.com ([10.238.154.54])
 by orsmga003.jf.intel.com with ESMTP; 02 Jun 2019 23:03:15 -0700
From: Xiaolin Zhang <xiaolin.zhang@intel.com>
To: intel-gvt-dev@lists.freedesktop.org,
	intel-gfx@lists.freedesktop.org
Subject: [PATCH v6 1/8] drm/i915: introduced vgpu pv capability
Date: Mon,  3 Jun 2019 14:02:42 +0800
Message-Id: <1559541769-25279-2-git-send-email-xiaolin.zhang@intel.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1559541769-25279-1-git-send-email-xiaolin.zhang@intel.com>
References: <1559541769-25279-1-git-send-email-xiaolin.zhang@intel.com>
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: Xiaolin Zhang <xiaolin.zhang@intel.com>, zhenyu.z.wang@intel.com,
 joonas.lahtinen@linux.intel.com, hang.yuan@intel.com, min.he@intel.com,
 zhiyuan.lv@intel.com, chris@chris-wilson.co.uk, zhi.a.wang@intel.com
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

cHYgY2FwYWJpbGl0eSBmb3IgdmdwdSB3YXMgaW50cm9kdWNlZCBieSBwdl9jYXBzIGluIHN0cnVj
dAppOTE1X3ZpcnR1YWxfZ3B1IGFuZCBhIG5ldyBwdl9jYXBzIHJlZ2lzdGVyIGZvciBob3N0IEdW
VAp3YXMgZGVmaW5lZCBpbiBzdHJ1Y3Qgdmd0X2lmIGZvciB2Z3B1IHB2IG9wdGltaXphdGlvbi4K
CmJvdGggb2YgdGhlbSBhcmUgdXNlZCB0byBjb250cm9sIGRpZmZlcmVudCBmZWF0dXJlIHB2IG9w
dGltaXphdGlvbgpzdXBwb3J0ZWQgYW5kIGltcGxlbWVudGVkIGJ5IGJvdGggZ3Vlc3QgYW5kIGhv
c3QuCgpUaGVzZSBmaWVsZHMgYXJlIGRlZmF1bHQgemVybywgbm8gYW55IHB2IGZlYXR1cmUgZW5h
YmxlZC4KCml0IGFsc28gYWRkcyBWR1RfQ0FQU19QViBjYXBhYmlsaXR5IEJJVCBmb3IgZ3Vlc3Qg
dG8gY2hlY2sgR1ZUZwpjYW4gc3VwcG9ydCBQViBmZWF0dXJlIG9yIG5vdC4KCnYwOiBSRkMsIGlu
dHJvdWRjZWQgZW5hYmxlX3B2bW1pbyBtb2R1bGUgcGFyYW1ldGVyLgp2MTogYWRkcmVzc2VkIFJG
QyBjb21tZW50IHRvIHJlbW92ZSBlbmFibGVfcHZtbWlvIG1vZHVsZSBwYXJhbWV0ZXIKYnkgcHYg
Y2FwYWJpbGl0eSBjaGVjay4KdjI6IHJlYmFzZS4KdjM6IGRpc3RpbmN0IHB2IGNhcHMgZnJvbSBn
dWVzdCBhbmQgaG9zdC4gcmVuYW1lZCBlbmFibGVfcHZtbWlvIHRvCnB2bW1pb19jYXBzIHdoaWNo
IGlzIHVzZWQgZm9yIGhvc3QgcHYgY2Fwcy4KdjQ6IGNvbnNvbGlkYXRlZCBhbGwgcHYgcmVsYXRl
ZCBmdW5jdG9ucyBpbnRvIGEgc2luZ2xlIGZpbGUgaTkxNV92Z3B1LmMKYW5kIHJlbmFtZWQgcHZt
bWlvIHRvIHB2X2NhcHMuCnY1OiByZWJhc2UuCnY2OiByZWJhc2UuCgpTaWduZWQtb2ZmLWJ5OiBY
aWFvbGluIFpoYW5nIDx4aWFvbGluLnpoYW5nQGludGVsLmNvbT4KLS0tCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X2Rydi5oICAgIHwgIDIgKysKIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
cHZpbmZvLmggfCAgNSArKysrLQogZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92Z3B1LmMgICB8
IDQ0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystCiBkcml2ZXJzL2dwdS9k
cm0vaTkxNS9pOTE1X3ZncHUuaCAgIHwgIDggKysrKysrKwogNCBmaWxlcyBjaGFuZ2VkLCA1NyBp
bnNlcnRpb25zKCspLCAyIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2k5MTVfZHJ2LmggYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X2Rydi5oCmluZGV4
IDc2ZjJiZjkuLjJiYjM4YjQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVf
ZHJ2LmgKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9kcnYuaApAQCAtOTAsNiArOTAs
NyBAQAogI2luY2x1ZGUgImk5MTVfdm1hLmgiCiAKICNpbmNsdWRlICJpbnRlbF9ndnQuaCIKKyNp
bmNsdWRlICJpOTE1X3B2aW5mby5oIgogCiAvKiBHZW5lcmFsIGN1c3RvbWl6YXRpb246CiAgKi8K
QEAgLTEyNDIsNiArMTI0Myw3IEBAIHN0cnVjdCBpOTE1X2Zyb250YnVmZmVyX3RyYWNraW5nIHsK
IHN0cnVjdCBpOTE1X3ZpcnR1YWxfZ3B1IHsKIAlib29sIGFjdGl2ZTsKIAl1MzIgY2FwczsKKwl1
MzIgcHZfY2FwczsKIH07CiAKIC8qIHVzZWQgaW4gY29tcHV0aW5nIHRoZSBuZXcgd2F0ZXJtYXJr
cyBzdGF0ZSAqLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wdmluZm8u
aCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfcHZpbmZvLmgKaW5kZXggOTY5ZTUxNC4uNjE5
MzA1YSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV9wdmluZm8uaAorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3B2aW5mby5oCkBAIC01NSw2ICs1NSw3IEBAIGVu
dW0gdmd0X2cydl90eXBlIHsKICNkZWZpbmUgVkdUX0NBUFNfRlVMTF9QUEdUVAkJQklUKDIpCiAj
ZGVmaW5lIFZHVF9DQVBTX0hXU1BfRU1VTEFUSU9OCQlCSVQoMykKICNkZWZpbmUgVkdUX0NBUFNf
SFVHRV9HVFQJCUJJVCg0KQorI2RlZmluZSBWR1RfQ0FQU19QVgkJQklUKDUpCiAKIHN0cnVjdCB2
Z3RfaWYgewogCXU2NCBtYWdpYzsJCS8qIFZHVF9NQUdJQyAqLwpAQCAtMTA3LDcgKzEwOCw5IEBA
IHN0cnVjdCB2Z3RfaWYgewogCXUzMiBleGVjbGlzdF9jb250ZXh0X2Rlc2NyaXB0b3JfbG87CiAJ
dTMyIGV4ZWNsaXN0X2NvbnRleHRfZGVzY3JpcHRvcl9oaTsKIAotCXUzMiAgcnN2N1sweDIwMCAt
IDI0XTsgICAgLyogcGFkIHRvIG9uZSBwYWdlICovCisJdTMyIHB2X2NhcHM7CisKKwl1MzIgIHJz
djdbMHgyMDAgLSAyNV07ICAgIC8qIHBhZCB0byBvbmUgcGFnZSAqLwogfSBfX3BhY2tlZDsKIAog
I2RlZmluZSB2Z3RpZl9yZWcoeCkgXApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUv
aTkxNV92Z3B1LmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuYwppbmRleCA5NGQz
OTkyLi5iYjlmOTg4IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUu
YworKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZncHUuYwpAQCAtNzksNyArNzksMTQg
QEAgdm9pZCBpOTE1X2NoZWNrX3ZncHUoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQogCWRldl9wcml2LT52Z3B1LmNhcHMgPSBfX3Jhd191bmNvcmVfcmVhZDMyKHVuY29yZSwgdmd0
aWZfcmVnKHZndF9jYXBzKSk7CiAKIAlkZXZfcHJpdi0+dmdwdS5hY3RpdmUgPSB0cnVlOwotCURS
TV9JTkZPKCJWaXJ0dWFsIEdQVSBmb3IgSW50ZWwgR1ZULWcgZGV0ZWN0ZWQuXG4iKTsKKworCWlm
ICghaW50ZWxfdmdwdV9jaGVja19wdl9jYXBzKGRldl9wcml2KSkgeworCQlEUk1fSU5GTygiVmly
dHVhbCBHUFUgZm9yIEludGVsIEdWVC1nIGRldGVjdGVkLlxuIik7CisJCXJldHVybjsKKwl9CisK
KwlEUk1fSU5GTygiVmlydHVhbCBHUFUgZm9yIEludGVsIEdWVC1nIGRldGVjdGVkIHdpdGggcHZf
Y2FwcyAweCV4LlxuIiwKKwkJCWRldl9wcml2LT52Z3B1LnB2X2NhcHMpOwogfQogCiBib29sIGlu
dGVsX3ZncHVfaGFzX2Z1bGxfcHBndHQoc3RydWN0IGRybV9pOTE1X3ByaXZhdGUgKmRldl9wcml2
KQpAQCAtMjc0LDMgKzI4MSwzOCBAQCBpbnQgaW50ZWxfdmd0X2JhbGxvb24oc3RydWN0IGRybV9p
OTE1X3ByaXZhdGUgKmRldl9wcml2KQogCURSTV9FUlJPUigiVkdUIGJhbGxvb24gZmFpbFxuIik7
CiAJcmV0dXJuIHJldDsKIH0KKworLyoKKyAqIGk5MTUgdmdwdSBQViBzdXBwb3J0IGZvciBMaW51
eAorICovCisKKy8qKgorICogaW50ZWxfdmdwdV9jaGVja19wdl9jYXBzIC0gZGV0ZWN0IHZpcnR1
YWwgR1BVIFBWIGNhcGFiaWxpdGllcworICogQGRldl9wcml2OiBpOTE1IGRldmljZSBwcml2YXRl
CisgKgorICogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgYXQgdGhlIGluaXRpYWxpemF0aW9uIHN0
YWdlLCB0byBkZXRlY3QgVkdQVQorICogUFYgY2FwYWJpbGl0aWVzCisgKgorICogSWYgZ3Vlc3Qg
d2FudHMgdG8gZW5hYmxlIHB2X2NhcHMsIGl0IG5lZWRzIHRvIGNvbmZpZyBpdCBleHBsaWNpdGx5
CisgKiB0aHJvdWdoIHZndF9pZiBpbnRlcmZhY2UgZnJvbSBndnQgbGF5ZXIuCisgKi8KK2Jvb2wg
aW50ZWxfdmdwdV9jaGVja19wdl9jYXBzKHN0cnVjdCBkcm1faTkxNV9wcml2YXRlICpkZXZfcHJp
dikKK3sKKwlzdHJ1Y3QgaW50ZWxfdW5jb3JlICp1bmNvcmUgPSAmZGV2X3ByaXYtPnVuY29yZTsK
Kwl1MzIgZ3Z0X3B2Y2FwczsKKwl1MzIgcHZjYXBzID0gMDsKKworCWlmICghaW50ZWxfdmdwdV9o
YXNfcHZfY2FwcyhkZXZfcHJpdikpCisJCXJldHVybiBmYWxzZTsKKworCS8qIFBWIGNhcGFiaWxp
dHkgbmVnb3RpYXRpb24gYmV0d2VlbiBQViBndWVzdCBhbmQgR1ZUICovCisJZ3Z0X3B2Y2FwcyA9
IF9fcmF3X3VuY29yZV9yZWFkMzIodW5jb3JlLCB2Z3RpZl9yZWcocHZfY2FwcykpOworCXB2Y2Fw
cyA9IGRldl9wcml2LT52Z3B1LnB2X2NhcHMgJiBndnRfcHZjYXBzOworCWRldl9wcml2LT52Z3B1
LnB2X2NhcHMgPSBwdmNhcHM7CisJX19yYXdfdW5jb3JlX3dyaXRlMzIodW5jb3JlLCB2Z3RpZl9y
ZWcocHZfY2FwcyksIHB2Y2Fwcyk7CisKKwlpZiAoIXB2Y2FwcykKKwkJcmV0dXJuIGZhbHNlOwor
CisJcmV0dXJuIHRydWU7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3ZncHUuaCBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5oCmluZGV4IGViZTFiN2Iu
LjkxMDEwZmMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5oCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdmdwdS5oCkBAIC00Miw3ICs0MiwxNSBAQCBp
bnRlbF92Z3B1X2hhc19odWdlX2d0dChzdHJ1Y3QgZHJtX2k5MTVfcHJpdmF0ZSAqZGV2X3ByaXYp
CiAJcmV0dXJuIGRldl9wcml2LT52Z3B1LmNhcHMgJiBWR1RfQ0FQU19IVUdFX0dUVDsKIH0KIAor
c3RhdGljIGlubGluZSBib29sCitpbnRlbF92Z3B1X2hhc19wdl9jYXBzKHN0cnVjdCBkcm1faTkx
NV9wcml2YXRlICpkZXZfcHJpdikKK3sKKwlyZXR1cm4gZGV2X3ByaXYtPnZncHUuY2FwcyAmIFZH
VF9DQVBTX1BWOworfQorCiBpbnQgaW50ZWxfdmd0X2JhbGxvb24oc3RydWN0IGRybV9pOTE1X3By
aXZhdGUgKmRldl9wcml2KTsKIHZvaWQgaW50ZWxfdmd0X2RlYmFsbG9vbihzdHJ1Y3QgZHJtX2k5
MTVfcHJpdmF0ZSAqZGV2X3ByaXYpOwogCisvKiBpOTE1IHZncHUgcHYgcmVsYXRlZCBmdW5jdGlv
bnMgKi8KK2Jvb2wgaW50ZWxfdmdwdV9jaGVja19wdl9jYXBzKHN0cnVjdCBkcm1faTkxNV9wcml2
YXRlICpkZXZfcHJpdik7CiAjZW5kaWYgLyogX0k5MTVfVkdQVV9IXyAqLwotLSAKMi43LjQKCl9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCmludGVsLWd2dC1k
ZXYgbWFpbGluZyBsaXN0CmludGVsLWd2dC1kZXZAbGlzdHMuZnJlZWRlc2t0b3Aub3JnCmh0dHBz
Oi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ3Z0LWRldg==
