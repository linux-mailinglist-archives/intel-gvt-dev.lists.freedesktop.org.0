Return-Path: <intel-gvt-dev-bounces@lists.freedesktop.org>
X-Original-To: lists+intel-gvt-dev@lfdr.de
Delivered-To: lists+intel-gvt-dev@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3B0641FDBD
	for <lists+intel-gvt-dev@lfdr.de>; Thu, 16 May 2019 04:30:26 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id EC69B89179;
	Thu, 16 May 2019 02:30:24 +0000 (UTC)
X-Original-To: intel-gvt-dev@lists.freedesktop.org
Delivered-To: intel-gvt-dev@lists.freedesktop.org
Received: from mga07.intel.com (mga07.intel.com [134.134.136.100])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 47D2889179
 for <intel-gvt-dev@lists.freedesktop.org>;
 Thu, 16 May 2019 02:30:23 +0000 (UTC)
X-Amp-Result: SKIPPED(no attachment in message)
X-Amp-File-Uploaded: False
Received: from orsmga001.jf.intel.com ([10.7.209.18])
 by orsmga105.jf.intel.com with ESMTP/TLS/DHE-RSA-AES256-GCM-SHA384;
 15 May 2019 19:30:22 -0700
X-ExtLoop1: 1
Received: from fmsmsx104.amr.corp.intel.com ([10.18.124.202])
 by orsmga001.jf.intel.com with ESMTP; 15 May 2019 19:30:22 -0700
Received: from fmsmsx118.amr.corp.intel.com (10.18.116.18) by
 fmsmsx104.amr.corp.intel.com (10.18.124.202) with Microsoft SMTP Server (TLS)
 id 14.3.408.0; Wed, 15 May 2019 19:30:22 -0700
Received: from shsmsx154.ccr.corp.intel.com (10.239.6.54) by
 fmsmsx118.amr.corp.intel.com (10.18.116.18) with Microsoft SMTP Server (TLS)
 id 14.3.408.0; Wed, 15 May 2019 19:30:21 -0700
Received: from shsmsx104.ccr.corp.intel.com ([169.254.5.33]) by
 SHSMSX154.ccr.corp.intel.com ([169.254.7.136]) with mapi id 14.03.0415.000;
 Thu, 16 May 2019 10:30:20 +0800
From: "Zhang, Xiong Y" <xiong.y.zhang@intel.com>
To: "Zhang, Xiaolin" <xiaolin.zhang@intel.com>, Zhenyu Wang
 <zhenyuw@linux.intel.com>
Subject: RE: [PATCH v2] drm/i915/gvt: cancel dma map only for not present
 ggtt entry
Thread-Topic: [PATCH v2] drm/i915/gvt: cancel dma map only for not present
 ggtt entry
Thread-Index: AQHVCvZ1Sbg7lqdx2EyNguTp9kCk8qZtBBRg
Date: Thu, 16 May 2019 02:30:19 +0000
Message-ID: <8082FF9BCB2B054996454E47167FF4EC275DC3A9@SHSMSX104.ccr.corp.intel.com>
References: <20190515081921.4394-1-xiaolin.zhang@intel.com>
 <20190515090123.GU12913@zhen-hp.sh.intel.com>
 <073732E20AE4C540AE91DBC3F07D44608765E9A8@SHSMSX107.ccr.corp.intel.com>
In-Reply-To: <073732E20AE4C540AE91DBC3F07D44608765E9A8@SHSMSX107.ccr.corp.intel.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-titus-metadata-40: eyJDYXRlZ29yeUxhYmVscyI6IiIsIk1ldGFkYXRhIjp7Im5zIjoiaHR0cDpcL1wvd3d3LnRpdHVzLmNvbVwvbnNcL0ludGVsMyIsImlkIjoiZDY1ZWVkYzItNzc1My00MmU5LThjZTYtY2JlZGNjNjNjNWQ3IiwicHJvcHMiOlt7Im4iOiJDVFBDbGFzc2lmaWNhdGlvbiIsInZhbHMiOlt7InZhbHVlIjoiQ1RQX05UIn1dfV19LCJTdWJqZWN0TGFiZWxzIjpbXSwiVE1DVmVyc2lvbiI6IjE3LjEwLjE4MDQuNDkiLCJUcnVzdGVkTGFiZWxIYXNoIjoidkdqZk5KdUhSQ3M0TlVua3A5ZGM4ZHdkRDViZE16S21cL0Ezckt4MjZ4RHFBaEFXQTQrUzNZbU80T0JsczhDdlwvIn0=
x-ctpclassification: CTP_NT
dlp-product: dlpe-windows
dlp-version: 11.0.600.7
dlp-reaction: no-action
x-originating-ip: [10.239.127.40]
MIME-Version: 1.0
X-BeenThere: intel-gvt-dev@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Intel GVT \(Graphics Virtualization\) development list"
 <intel-gvt-dev.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/intel-gvt-dev>
List-Post: <mailto:intel-gvt-dev@lists.freedesktop.org>
List-Help: <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/intel-gvt-dev>, 
 <mailto:intel-gvt-dev-request@lists.freedesktop.org?subject=subscribe>
Cc: "Zhang, Xiong Y" <xiong.y.zhang@intel.com>,
 "intel-gvt-dev@lists.freedesktop.org" <intel-gvt-dev@lists.freedesktop.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: intel-gvt-dev-bounces@lists.freedesktop.org
Sender: "intel-gvt-dev" <intel-gvt-dev-bounces@lists.freedesktop.org>

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogaW50ZWwtZ3Z0LWRldiBb
bWFpbHRvOmludGVsLWd2dC1kZXYtYm91bmNlc0BsaXN0cy5mcmVlZGVza3RvcC5vcmddIE9uDQo+
IEJlaGFsZiBPZiBaaGFuZywgWGlhb2xpbg0KPiBTZW50OiBUaHVyc2RheSwgTWF5IDE2LCAyMDE5
IDg6MjEgQU0NCj4gVG86IFpoZW55dSBXYW5nIDx6aGVueXV3QGxpbnV4LmludGVsLmNvbT4NCj4g
Q2M6IGludGVsLWd2dC1kZXZAbGlzdHMuZnJlZWRlc2t0b3Aub3JnDQo+IFN1YmplY3Q6IFJlOiBb
UEFUQ0ggdjJdIGRybS9pOTE1L2d2dDogY2FuY2VsIGRtYSBtYXAgb25seSBmb3Igbm90IHByZXNl
bnQNCj4gZ2d0dCBlbnRyeQ0KPiANCj4gT24gMDUvMTUvMjAxOSAwNTowMiBQTSwgWmhlbnl1IFdh
bmcgd3JvdGU6DQo+ID4gT24gMjAxOS4wNS4xNSAxNjoxOToyMSArMDgwMCwgWGlhb2xpbiBaaGFu
ZyB3cm90ZToNCj4gPj4gb25seSBjYW5jZWwgZ2d0dCBlbnRyeSBkbWEgbWFwIGZvciBpbnZhbGlk
IGdndHQgZW50cnksIGRvbid0IGRvIGl0DQo+ID4+IGZvciBwYXJpdGlhbCB1cGRhdGUgb3Igb2xk
IGdndHQgZW50cnkuDQpbWmhhbmcsIFhpb25nIFldIGlmIGd1ZXN0IGp1c3QgbW9kaWZ5IGdndHQs
IG5vdCBjbGVhciB0aGVuIHdyaXRlLCB3aGVyZSB3aWxsIHRoZSBvbGQgZ2d0dCBlbnRyeSBiZSB1
bm1hcHBlZCA/DQpXaXRoIHRoaXMgZml4LCBpdCBzZWVtcyB0aGUgb2xkIGdndHQgZW50cnkgd2ls
bCBuZXZlciBiZSB1bm1hcHBlZC4NCg0KU3RpbGwgZG9uJ3QgY2xlYXIgd2h5IGdyYXBoaWMgYWNj
ZXNzIGl0IGFmdGVyIGdndHQgaGFzIGRyb3BwZWQgaXQuIEhvdyBhYm91dCB0aGlzIGNoYW5nZSA/
DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMNCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2d2dC9ndHQuYw0KQEAgLTIyNzUsMTAgKzIyNzUsMTEgQEAgc3RhdGljIGludCBl
bXVsYXRlX2dndHRfbW1pb193cml0ZShzdHJ1Y3QgaW50ZWxfdmdwdSAqdmdwdSwgdW5zaWduZWQg
aW50IG9mZiwNCiAgICAgICAgZ2d0dF9zZXRfZ3Vlc3RfZW50cnkoZ2d0dF9tbSwgJmUsIGdfZ3R0
X2luZGV4KTsNCg0KICAgICAgICBnZ3R0X2dldF9ob3N0X2VudHJ5KGdndHRfbW0sICZlLCBnX2d0
dF9pbmRleCk7DQotICAgICAgIGdndHRfaW52YWxpZGF0ZV9wdGUodmdwdSwgJmUpOw0KDQogICAg
ICAgIGdndHRfc2V0X2hvc3RfZW50cnkoZ2d0dF9tbSwgJm0sIGdfZ3R0X2luZGV4KTsNCiAgICAg
ICAgZ2d0dF9pbnZhbGlkYXRlKGd2dC0+ZGV2X3ByaXYpOw0KKw0KKyAgICAgICBnZ3R0X2ludmFs
aWRhdGVfcHRlKHZncHUsICZlKTsNCiAgICAgICAgcmV0dXJuIDA7DQogfQ0KDQp0aGFua3MNCj4g
Pj4NCj4gPj4gdGhpcyBjaGFuZ2UgY2FuIGFkZHJlc3MgRE1BICJmYXVsdCByZWFzb24gMjMiIGlz
c3VlIGZvciB3aW4gZ3Vlc3QNCj4gPj4gd2l0aCBpbnRlbCBpb21tdSBvbi4NCj4gPj4NCj4gPj4g
djI6IHVwZGF0ZSBoYW5kbGluZyBvZiBnZ3R0IHBhcnRpYWwgdXBkYXRlIChaaGVueXUsIFlhbiwg
SGVucnkpDQo+ID4+DQo+ID4+IFNpZ25lZC1vZmYtYnk6IFhpYW9saW4gWmhhbmcgPHhpYW9saW4u
emhhbmdAaW50ZWwuY29tPg0KPiA+PiAtLS0NCj4gPj4gIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2d2
dC9ndHQuYyB8IDIxICsrKysrKysrKysrKy0tLS0tLS0tLQ0KPiA+PiAgMSBmaWxlIGNoYW5nZWQs
IDEyIGluc2VydGlvbnMoKyksIDkgZGVsZXRpb25zKC0pDQo+ID4+DQo+ID4+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMNCj4gPj4gYi9kcml2ZXJzL2dwdS9kcm0v
aTkxNS9ndnQvZ3R0LmMgaW5kZXggYzJmN2QyMGY2MzQ2Li40ODU2YjlmZWM0MTENCj4gPj4gMTAw
NjQ0DQo+ID4+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYw0KPiA+PiArKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0LmMNCj4gPj4gQEAgLTIyNDMsMTAgKzIyNDMs
MjEgQEAgc3RhdGljIGludCBlbXVsYXRlX2dndHRfbW1pb193cml0ZShzdHJ1Y3QNCj4gaW50ZWxf
dmdwdSAqdmdwdSwgdW5zaWduZWQgaW50IG9mZiwNCj4gPj4gIAkJfQ0KPiA+PiAgCX0NCj4gPj4N
Cj4gPj4gLQlpZiAoIXBhcnRpYWxfdXBkYXRlICYmIChvcHMtPnRlc3RfcHJlc2VudCgmZSkpKSB7
DQo+ID4+ICsJaWYgKCFvcHMtPnRlc3RfcHJlc2VudCgmZSkpIHsNCj4gPj4gKwkJZ2d0dF9nZXRf
aG9zdF9lbnRyeShnZ3R0X21tLCAmbSwgZ19ndHRfaW5kZXgpOw0KPiA+PiArCQlnZ3R0X2ludmFs
aWRhdGVfcHRlKHZncHUsICZtKTsNCj4gPj4gKwkJb3BzLT5zZXRfcGZuKCZtLCBndnQtPmd0dC5z
Y3JhdGNoX21mbik7DQo+ID4+ICsJCW9wcy0+Y2xlYXJfcHJlc2VudCgmbSk7DQo+ID4+ICsJfSBl
bHNlIHsNCj4gPj4gIAkJZ2ZuID0gb3BzLT5nZXRfcGZuKCZlKTsNCj4gPj4gIAkJbSA9IGU7DQo+
ID4+DQo+ID4+ICsJCWlmIChwYXJ0aWFsX3VwZGF0ZSkgew0KPiA+PiArCQkJb3BzLT5zZXRfcGZu
KCZtLCBndnQtPmd0dC5zY3JhdGNoX21mbik7DQo+ID4+ICsJCQlvcHMtPmNsZWFyX3ByZXNlbnQo
Jm0pOw0KPiA+PiArCQkJZ290byBvdXQ7DQo+ID4+ICsJCX0NCj4gPj4gKw0KPiA+PiAgCQkvKiBv
bmUgUFRFIHVwZGF0ZSBtYXkgYmUgaXNzdWVkIGluIG11bHRpcGxlIHdyaXRlcyBhbmQgdGhlDQo+
ID4+ICAJCSAqIGZpcnN0IHdyaXRlIG1heSBub3QgY29uc3RydWN0IGEgdmFsaWQgZ2ZuDQo+ID4+
ICAJCSAqLw0KPiA+PiBAQCAtMjI2NiwxNyArMjI3Nyw5IEBAIHN0YXRpYyBpbnQgZW11bGF0ZV9n
Z3R0X21taW9fd3JpdGUoc3RydWN0DQo+IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBv
ZmYsDQo+ID4+ICAJCQlvcHMtPnNldF9wZm4oJm0sIGd2dC0+Z3R0LnNjcmF0Y2hfbWZuKTsNCj4g
Pj4gIAkJfSBlbHNlDQo+ID4+ICAJCQlvcHMtPnNldF9wZm4oJm0sIGRtYV9hZGRyID4+IFBBR0Vf
U0hJRlQpOw0KPiA+PiAtCX0gZWxzZSB7DQo+ID4+IC0JCW9wcy0+c2V0X3BmbigmbSwgZ3Z0LT5n
dHQuc2NyYXRjaF9tZm4pOw0KPiA+PiAtCQlvcHMtPmNsZWFyX3ByZXNlbnQoJm0pOw0KPiA+PiAg
CX0NCj4gPj4gLQ0KPiA+PiAgb3V0Og0KPiA+PiAgCWdndHRfc2V0X2d1ZXN0X2VudHJ5KGdndHRf
bW0sICZlLCBnX2d0dF9pbmRleCk7DQo+ID4+IC0NCj4gPj4gLQlnZ3R0X2dldF9ob3N0X2VudHJ5
KGdndHRfbW0sICZlLCBnX2d0dF9pbmRleCk7DQo+ID4+IC0JZ2d0dF9pbnZhbGlkYXRlX3B0ZSh2
Z3B1LCAmZSk7DQo+ID4+IC0NCj4gPj4gIAlnZ3R0X3NldF9ob3N0X2VudHJ5KGdndHRfbW0sICZt
LCBnX2d0dF9pbmRleCk7DQo+ID4+ICAJZ2d0dF9pbnZhbGlkYXRlKGd2dC0+ZGV2X3ByaXYpOw0K
PiA+PiAgCXJldHVybiAwOw0KPiA+PiAtLQ0KPiA+IEhvdyBhYm91dCBiZWxvdyBzaW1wbGVyIGNo
YW5nZT8NCj4gPg0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9ndnQvZ3R0
LmMNCj4gPiBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYyBpbmRleCAwOGM3NGU2NTgz
NmIuLjhmMjdkYjlkN2ExZQ0KPiA+IDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvZ3B1L2RybS9p
OTE1L2d2dC9ndHQuYw0KPiA+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2d2dC9ndHQuYw0K
PiA+IEBAIC0yMjY5LDE2ICsyMjY5LDE2IEBAIHN0YXRpYyBpbnQgZW11bGF0ZV9nZ3R0X21taW9f
d3JpdGUoc3RydWN0DQo+IGludGVsX3ZncHUgKnZncHUsIHVuc2lnbmVkIGludCBvZmYsDQo+ID4g
IAkJCW9wcy0+c2V0X3BmbigmbSwgZ3Z0LT5ndHQuc2NyYXRjaF9tZm4pOw0KPiA+ICAJCX0gZWxz
ZQ0KPiA+ICAJCQlvcHMtPnNldF9wZm4oJm0sIGRtYV9hZGRyID4+IFBBR0VfU0hJRlQpOw0KPiA+
IC0JfSBlbHNlIHsNCj4gPiArCX0gZWxzZQ0KPiA+ICAJCW9wcy0+c2V0X3BmbigmbSwgZ3Z0LT5n
dHQuc2NyYXRjaF9tZm4pOw0KPiA+IC0JCW9wcy0+Y2xlYXJfcHJlc2VudCgmbSk7DQo+ID4gLQl9
DQo+ID4NCj4gPiAgb3V0Og0KPiA+ICAJZ2d0dF9zZXRfZ3Vlc3RfZW50cnkoZ2d0dF9tbSwgJmUs
IGdfZ3R0X2luZGV4KTsNCj4gPg0KPiA+IC0JZ2d0dF9nZXRfaG9zdF9lbnRyeShnZ3R0X21tLCAm
ZSwgZ19ndHRfaW5kZXgpOw0KPiA+IC0JZ2d0dF9pbnZhbGlkYXRlX3B0ZSh2Z3B1LCAmZSk7DQo+
ID4gKwlpZiAoIXBhcnRpYWxfdXBkYXRlKSB7DQo+ID4gKwkJZ2d0dF9nZXRfaG9zdF9lbnRyeShn
Z3R0X21tLCAmZSwgZ19ndHRfaW5kZXgpOw0KPiA+ICsJCWdndHRfaW52YWxpZGF0ZV9wdGUodmdw
dSwgJmUpOw0KPiA+ICsJfQ0KPiB0aGlzIGNoYW5nZSBkb2VzIG5vdCB3b3JrIGFmdGVyIGEgdGVz
dCBhbmQgdGhpcyBjaGFuZ2Ugd2FzICBwb2ludGVkIG91dCBieQ0KPiBIZW5yeSBiZWZvcmUgZXhj
ZXB0IHlvdXIgY2xlYXIgcHJlc2VudC4gQW5vdGhlciB0ZXN0IGlzIHRoYXQgaWYgd2UgY2hhbmdl
ICJpZg0KPiAoIXBhcnRpYWxfdXBkYXRlKSIgdG8gImlmICghb3BzLT50ZXN0X3ByZXNlbnQoJmUp
KSIgYWZ0ZXIgbGFiZWwgb3V0LCBpdCB3aWxsIHdvcmsuDQo+IGJ1dCB0aGlzIGNoYW5nZSBpcyBl
c3NlbnRpYWwgdG8gdGhlIHNhbWUgbXkgcGF0Y2ggc2V0IGFuZCBpcyBub3QgZ29vZA0KPiByZWFk
YWJsZSB0aGFuIG15IHBhdGNoIHNldCBwZXIgbXkgb3Bpbmlvbi4NCj4gPg0KPiA+ICAJZ2d0dF9z
ZXRfaG9zdF9lbnRyeShnZ3R0X21tLCAmbSwgZ19ndHRfaW5kZXgpOw0KPiA+ICAJZ2d0dF9pbnZh
bGlkYXRlKGd2dC0+ZGV2X3ByaXYpOw0KPiA+DQo+ID4NCj4gDQo+IF9fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fDQo+IGludGVsLWd2dC1kZXYgbWFpbGluZyBs
aXN0DQo+IGludGVsLWd2dC1kZXZAbGlzdHMuZnJlZWRlc2t0b3Aub3JnDQo+IGh0dHBzOi8vbGlz
dHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vaW50ZWwtZ3Z0LWRldg0KX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KaW50ZWwtZ3Z0LWRldiBt
YWlsaW5nIGxpc3QKaW50ZWwtZ3Z0LWRldkBsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9s
aXN0cy5mcmVlZGVza3RvcC5vcmcvbWFpbG1hbi9saXN0aW5mby9pbnRlbC1ndnQtZGV2
